{% extends 'base.html' %}
{% block title %}<title>Item Detail</title>{% endblock %}
{% block bodytag %} class="home" {% endblock %}
{% block content %}

<div class="item-detail-container flex">
    <div class="item-left">
        <div class="item-detail-img-container center-container">
            <img src="https://i0.wp.com/sofiestdesigns.com/wp-content/uploads/2022/05/SilverMushroom.jpg?fit=768%2C768&ssl=1">
        </div>
    </div>
    <div class="item-right">
        {% if primarytrades.count or item.trade_proposed.count %}
        <div class="marquee">
            <ul class="marquee-content">
                <li>trade in progress</li>
            </ul>
            <ul class="marquee-content" aria-hidden="true">
                <li>trade in progress</li>
            </ul>
        </div>
        {% endif %}
        <div class="item-detail-text">
            <div><h1>{{item.name}}</h1></div>
            <div><h3>posted by: {{item.user}}</h3></div>
            <div>{{item.description}}</div>
        </div>
        <div class="item-btns">
            {% for trade in item.trade_primary.all %}
            <div class="item-detail-curtrade-detail">
                <div>Trade Initiated By: {{trade.item_proposed.user}}</div>
                <div>Trade For: <a href="{% url 'item_detail' trade.item_proposed.id%}" class="decorate-anchor">{{trade.item_proposed}}</a></div>
                <div>Comments: {% if trade.comment %} {{trade.comment}} {% else %} no comment {% endif%}</div>
            </div>
                {% if item.user == user %}
                <div class="btn-container"><a href="{% url 'trade_approve' trade.id %}"><div class="btn dark-grn-bckgrnd">APPROVE TRADE</div></a></div>
                <div class="btn-container"><a href="{% url 'trade_reject' trade.id %}"><div class="btn dark-grn-bckgrnd">REJECT TRADE</div></a></div>
                {% endif %}
            {% empty %}
                {% if item.user == user and item.trade_proposed.count == 0 %}
                <div class="btn-container"><a href="{% url 'item_update' item.id %}"><div class="btn dark-grn-bckgrnd">EDIT</div></a></div>
                <div class="btn-container"><a href="{% url 'item_delete' item.id %}"><div class="btn dark-grn-bckgrnd">DELETE</div></a></div>
                {% endif %}
            {% endfor %}
            {% if not item.user == user and item.trade_proposed.count == 0 %}
            <div class="btn-container"><a href="{% url 'trade_create' item.id %}"><div class="btn dark-grn-bckgrnd">TRADE FOR THIS ITEM</div></a></div>
            {% endif %}
        </div>
    </div>
</div>

{% if item.user == user %}
{% for photo in item.photo_set.all %}
<img class="responsive-img card-panel" src="{{photo.url}}">
{% empty %}
<div class="card-panel teal-text center-align">No Photos Uploaded</div>
{% endfor %}
<form action="{% url 'add_photo' item.id %}" enctype="multipart/form-data" method="POST" class="card-panel">
    {% csrf_token %}
    <input type="file" name="photo-file">
    <br><br>
    <button type="submit" class="btn">Upload Photo</button>
</form>
{% endif %}

{% endblock %}